#include <iostream>
#include <queue>
#include <unordered_set>
using namespace std;

int main() {
    int frames, n;
    cout << "Enter number of frames: ";
    cin >> frames;

    cout << "Enter number of references: ";
    cin >> n;

    int ref[n];
    cout << "Enter the reference string: ";
    for (int i = 0; i < n; i++) {
        cin >> ref[i];
    }

    unordered_set<int> memory;
    queue<int> q;
    int pageFaults = 0, pageHits = 0;

    cout << "\n--- FIFO Page Replacement ---\n";

    for (int i = 0; i < n; i++) {
        int page = ref[i];
        cout << "\nStep " << i + 1 << ": Page " << page << " : ";

        // Page not found (Page Fault)
        if (memory.find(page) == memory.end()) {
            pageFaults++;

            // If frames are full, remove the oldest page
            if (memory.size() == frames) {
                int oldest = q.front();
                q.pop();
                memory.erase(oldest);
                cout << "Replaced page " << oldest << " with page " << page << ". (Page Fault)";
            } else {
                cout << "Inserted page " << page << ". (Page Fault)";
            }

            memory.insert(page);
            q.push(page);
        }
        else {
            pageHits++;
            cout << "Page " << page << " already present. (Page Hit)";
        }

        // Show current memory
        cout << "\nFrames: ";
        queue<int> temp = q;
        while (!temp.empty()) {
            cout << temp.front() << " ";
            temp.pop();
        }
    }

    cout << "\n\nTotal Page Faults: " << pageFaults;
    cout << "\nTotal Page Hits: " << pageHits;

    float hitRatio = (float)pageHits / n * 100;
    float faultRatio = (float)pageFaults / n * 100;

    cout << "\nHit Ratio: " << hitRatio << "%";
    cout << "\nFault Ratio: " << faultRatio << "%\n";

    return 0;
}